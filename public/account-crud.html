<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Account CRUD Operations</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1, h2 {
      color: #333;
    }
    
    .card {
      background-color: #fff;
      border-radius: 5px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    
    button {
      padding: 10px 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    
    button:hover {
      background-color: #45a049;
    }
    
    button.secondary {
      background-color: #2196F3;
    }
    
    button.secondary:hover {
      background-color: #0b7dda;
    }
    
    button.danger {
      background-color: #f44336;
    }
    
    button.danger:hover {
      background-color: #d32f2f;
    }
    
    .result {
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 15px;
      margin-top: 15px;
      overflow-x: auto;
    }
    
    pre {
      margin: 0;
      white-space: pre-wrap;
    }
    
    .error-message {
      color: #c62828;
      background-color: #ffebee;
      padding: 10px;
      border-radius: 4px;
      margin-top: 10px;
    }
    
    .success-message {
      color: #2e7d32;
      background-color: #e8f5e9;
      padding: 10px;
      border-radius: 4px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Customer Account CRUD Operations</h1>
    
    <!-- Create Account Section -->
    <div class="card">
      <h2>Create New Account</h2>
      <form id="create-form">
        <div class="form-group">
          <label for="create-name">Name *</label>
          <input type="text" id="create-name" required placeholder="Enter account name">
        </div>
        <div class="form-group">
          <label for="create-industry">Industry *</label>
          <input type="text" id="create-industry" required placeholder="Enter industry">
        </div>
        <div class="form-group">
          <label for="create-type">Type *</label>
          <select id="create-type" required>
            <option value="">Select Type</option>
            <option value="CUSTOMER">CUSTOMER</option>
            <option value="PROSPECT">PROSPECT</option>
            <option value="PARTNER">PARTNER</option>
            <option value="COMPETITOR">COMPETITOR</option>
            <option value="OTHER">OTHER</option>
          </select>
        </div>
        <div class="form-group">
          <label for="create-status">Status *</label>
          <select id="create-status" required>
            <option value="">Select Status</option>
            <option value="ACTIVE">ACTIVE</option>
            <option value="INACTIVE">INACTIVE</option>
            <option value="PENDING">PENDING</option>
            <option value="CLOSED">CLOSED</option>
          </select>
        </div>
        <div class="form-group">
          <label for="create-website">Website</label>
          <input type="url" id="create-website" placeholder="Enter website URL">
        </div>
        <div class="form-group">
          <label for="create-email">Email</label>
          <input type="email" id="create-email" placeholder="Enter email address">
        </div>
        <button type="submit">Create Account</button>
      </form>
      <div id="create-result" class="result" style="display: none;">
        <h3>Created Account</h3>
        <pre id="create-json"></pre>
      </div>
      <div id="create-error" class="error-message" style="display: none;"></div>
      <div id="create-success" class="success-message" style="display: none;"></div>
    </div>
    
    <!-- Get Accounts Section -->
    <div class="card">
      <h2>Get Accounts</h2>
      <div class="form-group">
        <label for="get-name">Filter by Name</label>
        <input type="text" id="get-name" placeholder="Enter name to filter">
      </div>
      <div class="form-group">
        <label for="get-industry">Filter by Industry</label>
        <input type="text" id="get-industry" placeholder="Enter industry to filter">
      </div>
      <div class="form-group">
        <label for="get-type">Filter by Type</label>
        <select id="get-type">
          <option value="">All Types</option>
          <option value="CUSTOMER">CUSTOMER</option>
          <option value="PROSPECT">PROSPECT</option>
          <option value="PARTNER">PARTNER</option>
          <option value="COMPETITOR">COMPETITOR</option>
          <option value="OTHER">OTHER</option>
        </select>
      </div>
      <div class="form-group">
        <label for="get-status">Filter by Status</label>
        <select id="get-status">
          <option value="">All Statuses</option>
          <option value="ACTIVE">ACTIVE</option>
          <option value="INACTIVE">INACTIVE</option>
          <option value="PENDING">PENDING</option>
          <option value="CLOSED">CLOSED</option>
        </select>
      </div>
      <button id="get-accounts-btn">Get Accounts</button>
      <div id="get-result" class="result" style="display: none;">
        <h3>Accounts</h3>
        <pre id="get-json"></pre>
      </div>
      <div id="get-error" class="error-message" style="display: none;"></div>
    </div>
    
    <!-- Get Single Account Section -->
    <div class="card">
      <h2>Get Account by ID</h2>
      <div class="form-group">
        <label for="get-id">Account ID</label>
        <input type="text" id="get-id" placeholder="Enter account ID">
      </div>
      <button id="get-account-btn">Get Account</button>
      <div id="get-single-result" class="result" style="display: none;">
        <h3>Account Details</h3>
        <pre id="get-single-json"></pre>
      </div>
      <div id="get-single-error" class="error-message" style="display: none;"></div>
    </div>
    
    <!-- Update Account Section -->
    <div class="card">
      <h2>Update Account</h2>
      <div class="form-group">
        <label for="update-id">Account ID *</label>
        <input type="text" id="update-id" required placeholder="Enter account ID">
      </div>
      <button id="load-account-btn">Load Account</button>
      
      <form id="update-form" style="display: none; margin-top: 20px;">
        <div class="form-group">
          <label for="update-name">Name</label>
          <input type="text" id="update-name" placeholder="Enter account name">
        </div>
        <div class="form-group">
          <label for="update-industry">Industry</label>
          <input type="text" id="update-industry" placeholder="Enter industry">
        </div>
        <div class="form-group">
          <label for="update-type">Type</label>
          <select id="update-type">
            <option value="">Select Type</option>
            <option value="CUSTOMER">CUSTOMER</option>
            <option value="PROSPECT">PROSPECT</option>
            <option value="PARTNER">PARTNER</option>
            <option value="COMPETITOR">COMPETITOR</option>
            <option value="OTHER">OTHER</option>
          </select>
        </div>
        <div class="form-group">
          <label for="update-status">Status</label>
          <select id="update-status">
            <option value="">Select Status</option>
            <option value="ACTIVE">ACTIVE</option>
            <option value="INACTIVE">INACTIVE</option>
            <option value="PENDING">PENDING</option>
            <option value="CLOSED">CLOSED</option>
          </select>
        </div>
        <div class="form-group">
          <label for="update-website">Website</label>
          <input type="url" id="update-website" placeholder="Enter website URL">
        </div>
        <div class="form-group">
          <label for="update-email">Email</label>
          <input type="email" id="update-email" placeholder="Enter email address">
        </div>
        <button type="submit">Update Account</button>
      </form>
      
      <div id="update-result" class="result" style="display: none;">
        <h3>Updated Account</h3>
        <pre id="update-json"></pre>
      </div>
      <div id="update-error" class="error-message" style="display: none;"></div>
      <div id="update-success" class="success-message" style="display: none;"></div>
    </div>
    
    <!-- Delete Account Section -->
    <div class="card">
      <h2>Delete Account</h2>
      <div class="form-group">
        <label for="delete-id">Account ID</label>
        <input type="text" id="delete-id" placeholder="Enter account ID">
      </div>
      <div class="form-group">
        <label for="delete-force">Force Delete (if account has relationships)</label>
        <select id="delete-force">
          <option value="false">No</option>
          <option value="true">Yes</option>
        </select>
      </div>
      <button id="delete-btn" class="danger">Delete Account</button>
      <div id="delete-result" class="result" style="display: none;">
        <h3>Delete Result</h3>
        <pre id="delete-json"></pre>
      </div>
      <div id="delete-error" class="error-message" style="display: none;"></div>
      <div id="delete-success" class="success-message" style="display: none;"></div>
    </div>
  </div>
  
  <script>
    // Create Account
    const createForm = document.getElementById('create-form');
    const createResult = document.getElementById('create-result');
    const createJson = document.getElementById('create-json');
    const createError = document.getElementById('create-error');
    const createSuccess = document.getElementById('create-success');
    
    createForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      try {
        // Reset messages
        createResult.style.display = 'none';
        createError.style.display = 'none';
        createSuccess.style.display = 'none';
        
        // Get form data
        const accountData = {
          name: document.getElementById('create-name').value,
          industry: document.getElementById('create-industry').value,
          type: document.getElementById('create-type').value,
          status: document.getElementById('create-status').value,
          website: document.getElementById('create-website').value || undefined,
          email: document.getElementById('create-email').value || undefined
        };
        
        // Make API request
        const response = await fetch('/api/accounts', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(accountData)
        });
        
        const data = await response.json();
        
        if (!response.ok) {
          throw new Error(data.message || 'Failed to create account');
        }
        
        // Show result
        createJson.textContent = JSON.stringify(data, null, 2);
        createResult.style.display = 'block';
        createSuccess.textContent = 'Account created successfully!';
        createSuccess.style.display = 'block';
        
        // Reset form
        createForm.reset();
      } catch (error) {
        createError.textContent = `Error: ${error.message}`;
        createError.style.display = 'block';
      }
    });
    
    // Get Accounts
    const getAccountsBtn = document.getElementById('get-accounts-btn');
    const getResult = document.getElementById('get-result');
    const getJson = document.getElementById('get-json');
    const getError = document.getElementById('get-error');
    
    getAccountsBtn.addEventListener('click', async () => {
      try {
        // Reset messages
        getResult.style.display = 'none';
        getError.style.display = 'none';
        
        // Build query parameters
        const queryParams = new URLSearchParams();
        
        const nameFilter = document.getElementById('get-name').value;
        const industryFilter = document.getElementById('get-industry').value;
        const typeFilter = document.getElementById('get-type').value;
        const statusFilter = document.getElementById('get-status').value;
        
        if (nameFilter) queryParams.append('name', nameFilter);
        if (industryFilter) queryParams.append('industry', industryFilter);
        if (typeFilter) queryParams.append('type', typeFilter);
        if (statusFilter) queryParams.append('status', statusFilter);
        
        // Make API request
        const response = await fetch(`/api/accounts?${queryParams.toString()}`);
        
        if (!response.ok) {
          throw new Error(`Failed to fetch accounts: ${response.statusText}`);
        }
        
        const data = await response.json();
        
        // Show result
        getJson.textContent = JSON.stringify(data, null, 2);
        getResult.style.display = 'block';
      } catch (error) {
        getError.textContent = `Error: ${error.message}`;
        getError.style.display = 'block';
      }
    });
    
    // Get Single Account
    const getAccountBtn = document.getElementById('get-account-btn');
    const getSingleResult = document.getElementById('get-single-result');
    const getSingleJson = document.getElementById('get-single-json');
    const getSingleError = document.getElementById('get-single-error');
    
    getAccountBtn.addEventListener('click', async () => {
      try {
        // Reset messages
        getSingleResult.style.display = 'none';
        getSingleError.style.display = 'none';
        
        const accountId = document.getElementById('get-id').value;
        
        if (!accountId) {
          throw new Error('Account ID is required');
        }
        
        // Make API request
        const response = await fetch(`/api/accounts/${accountId}`);
        
        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('Account not found');
          }
          throw new Error(`Failed to fetch account: ${response.statusText}`);
        }
        
        const data = await response.json();
        
        // Show result
        getSingleJson.textContent = JSON.stringify(data, null, 2);
        getSingleResult.style.display = 'block';
      } catch (error) {
        getSingleError.textContent = `Error: ${error.message}`;
        getSingleError.style.display = 'block';
      }
    });
    
    // Update Account
    const loadAccountBtn = document.getElementById('load-account-btn');
    const updateForm = document.getElementById('update-form');
    const updateResult = document.getElementById('update-result');
    const updateJson = document.getElementById('update-json');
    const updateError = document.getElementById('update-error');
    const updateSuccess = document.getElementById('update-success');
    
    loadAccountBtn.addEventListener('click', async () => {
      try {
        // Reset messages
        updateForm.style.display = 'none';
        updateResult.style.display = 'none';
        updateError.style.display = 'none';
        updateSuccess.style.display = 'none';
        
        const accountId = document.getElementById('update-id').value;
        
        if (!accountId) {
          throw new Error('Account ID is required');
        }
        
        // Make API request
        const response = await fetch(`/api/accounts/${accountId}`);
        
        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('Account not found');
          }
          throw new Error(`Failed to fetch account: ${response.statusText}`);
        }
        
        const account = await response.json();
        
        // Populate form
        document.getElementById('update-name').value = account.name || '';
        document.getElementById('update-industry').value = account.industry || '';
        document.getElementById('update-type').value = account.type || '';
        document.getElementById('update-status').value = account.status || '';
        document.getElementById('update-website').value = account.website || '';
        document.getElementById('update-email').value = account.email || '';
        
        // Show form
        updateForm.style.display = 'block';
      } catch (error) {
        updateError.textContent = `Error: ${error.message}`;
        updateError.style.display = 'block';
      }
    });
    
    updateForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      try {
        // Reset messages
        updateResult.style.display = 'none';
        updateError.style.display = 'none';
        updateSuccess.style.display = 'none';
        
        const accountId = document.getElementById('update-id').value;
        
        // Get form data
        const accountData = {};
        
        const name = document.getElementById('update-name').value;
        const industry = document.getElementById('update-industry').value;
        const type = document.getElementById('update-type').value;
        const status = document.getElementById('update-status').value;
        const website = document.getElementById('update-website').value;
        const email = document.getElementById('update-email').value;
        
        if (name) accountData.name = name;
        if (industry) accountData.industry = industry;
        if (type) accountData.type = type;
        if (status) accountData.status = status;
        if (website) accountData.website = website;
        if (email) accountData.email = email;
        
        // Make API request
        const response = await fetch(`/api/accounts/${accountId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(accountData)
        });
        
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || 'Failed to update account');
        }
        
        const data = await response.json();
        
        // Show result
        updateJson.textContent = JSON.stringify(data, null, 2);
        updateResult.style.display = 'block';
        updateSuccess.textContent = 'Account updated successfully!';
        updateSuccess.style.display = 'block';
      } catch (error) {
        updateError.textContent = `Error: ${error.message}`;
        updateError.style.display = 'block';
      }
    });
    
    // Delete Account
    const deleteBtn = document.getElementById('delete-btn');
    const deleteResult = document.getElementById('delete-result');
    const deleteJson = document.getElementById('delete-json');
    const deleteError = document.getElementById('delete-error');
    const deleteSuccess = document.getElementById('delete-success');
    
    deleteBtn.addEventListener('click', async () => {
      try {
        // Reset messages
        deleteResult.style.display = 'none';
        deleteError.style.display = 'none';
        deleteSuccess.style.display = 'none';
        
        const accountId = document.getElementById('delete-id').value;
        const forceDelete = document.getElementById('delete-force').value;
        
        if (!accountId) {
          throw new Error('Account ID is required');
        }
        
        // Confirm deletion
        if (!confirm('Are you sure you want to delete this account?')) {
          return;
        }
        
        // Make API request
        const url = forceDelete === 'true' 
          ? `/api/accounts/${accountId}?force=true` 
          : `/api/accounts/${accountId}`;
          
        const response = await fetch(url, {
          method: 'DELETE'
        });
        
        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('Account not found');
          }
          
          const errorData = await response.json();
          throw new Error(errorData.message || 'Failed to delete account');
        }
        
        // Show success
        deleteSuccess.textContent = 'Account deleted successfully!';
        deleteSuccess.style.display = 'block';
        
        // Clear input
        document.getElementById('delete-id').value = '';
      } catch (error) {
        deleteError.textContent = `Error: ${error.message}`;
        deleteError.style.display = 'block';
      }
    });
  </script>
</body>
</html>